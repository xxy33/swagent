# GIS Agent å®ç°æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. å¤©æ°”æŸ¥è¯¢å·¥å…· (WeatherTool) âœ“
**æ–‡ä»¶ä½ç½®**: `swagent/tools/domain/weather_tool.py`

**åŠŸèƒ½**:
- âœ… æ ¹æ® GIS åæ ‡ï¼ˆçº¬åº¦ã€ç»åº¦ï¼‰æŸ¥è¯¢å¤©æ°”æ•°æ®
- âœ… æ”¯æŒæŸ¥è¯¢å½“å‰å¤©æ°”
- âœ… æ”¯æŒæŸ¥è¯¢æŒ‡å®šæ—¶é—´çš„å¤©æ°”ï¼ˆå†å²/é¢„æŠ¥ï¼‰
- âœ… è‡ªå®šä¹‰æ—¶åŒºæ”¯æŒ
- âœ… è¿”å›æ¸©åº¦ã€æ¹¿åº¦ã€é™æ°´é‡ã€é£é€Ÿç­‰ä¿¡æ¯
- âœ… ä½¿ç”¨ Open-Meteo APIï¼ˆå…è´¹ï¼Œæ— éœ€ API Keyï¼‰

**æµ‹è¯•çŠ¶æ€**: âœ… å·²æµ‹è¯•é€šè¿‡

### 2. å½±åƒåˆ‡ç‰‡å·¥å…· (ImageryTool) âœ“
**æ–‡ä»¶ä½ç½®**: `swagent/tools/domain/imagery_tool.py`

**åŠŸèƒ½**:
- âœ… æ ¹æ® GIS åæ ‡è·å–å«æ˜Ÿå½±åƒæ•°æ®
- âœ… æ”¯æŒä¸‰ç§æ•°æ®æºï¼š
  - Google Earth: é«˜æ¸…å«æ˜Ÿå›¾ï¼ˆé™æ€ï¼‰
  - å‰æ—ä¸€å·: å›½äº§å«æ˜Ÿå›¾ï¼ˆæ”¯æŒ 2022/2023/2024 å¹´ä»½ï¼‰
  - Sentinel-2: å“¨å…µ2å·å«æ˜Ÿå›¾ï¼ˆæ”¯æŒæ—¶é—´ç­›é€‰å’Œäº‘é‡è¿‡æ»¤ï¼‰
- âœ… æ”¯æŒç‚¹ä½æ¨¡å¼å’ŒåŒºåŸŸæ¨¡å¼
- âœ… è¿”å› numpy æ•°ç»„æˆ– base64 ç¼–ç å›¾ç‰‡
- âœ… åŠ¨æ€æ£€æµ‹å¯ç”¨çš„æ•°æ®æº

**æµ‹è¯•çŠ¶æ€**: âš ï¸ éœ€è¦é¢å¤–ä¾èµ–ï¼ˆè§ä¸‹æ–‡ï¼‰

### 3. å·¥å…·æ³¨å†Œ âœ“
**æ–‡ä»¶ä½ç½®**: `swagent/tools/domain/__init__.py`

- âœ… å·²å°†ä¸¤ä¸ªå·¥å…·å¯¼å‡ºåˆ°å·¥å…·æ¨¡å—
- âœ… å¯é€šè¿‡ `from swagent.tools.domain import WeatherTool, ImageryTool` ä½¿ç”¨

### 4. ç¤ºä¾‹ä»£ç  âœ“
**æ–‡ä»¶ä½ç½®**: `examples/gis_agent_demo.py`

åŒ…å« 4 ä¸ªå®Œæ•´ç¤ºä¾‹ï¼š
- âœ… ç¤ºä¾‹ 1: ç›´æ¥ä½¿ç”¨å¤©æ°”å·¥å…·
- âœ… ç¤ºä¾‹ 2: ç›´æ¥ä½¿ç”¨å½±åƒåˆ‡ç‰‡å·¥å…·
- âœ… ç¤ºä¾‹ 3: ä½¿ç”¨å·¥å…·æ³¨å†Œä¸­å¿ƒ
- âœ… ç¤ºä¾‹ 4: æ¼”ç¤ºå¦‚ä½•å‡†å¤‡å·¥å…·ä¾› Agent ä½¿ç”¨

### 5. ä½¿ç”¨æ–‡æ¡£ âœ“
**æ–‡ä»¶ä½ç½®**: `docs/GIS_TOOLS.md`

- âœ… å·¥å…·æ¦‚è¿°å’ŒåŠŸèƒ½è¯´æ˜
- âœ… å®‰è£…ä¾èµ–æŒ‡å—
- âœ… å¿«é€Ÿå¼€å§‹æ•™ç¨‹
- âœ… è¯¦ç»†çš„ API å‚æ•°è¯´æ˜
- âœ… å¤šä¸ªä½¿ç”¨ç¤ºä¾‹
- âœ… æ•…éšœæ’é™¤æŒ‡å—

### 6. ä¾èµ–ç®¡ç† âœ“
**æ–‡ä»¶ä½ç½®**: `requirements_gis.txt`

- âœ… åˆ›å»ºäº†ç‹¬ç«‹çš„ GIS å·¥å…·ä¾èµ–æ–‡ä»¶
- âœ… åˆ†å±‚ç®¡ç†ï¼šåŸºç¡€ä¾èµ– + å¯é€‰ä¾èµ–

## ğŸ“¦ ä¾èµ–å®‰è£…

### åŸºç¡€ä¾èµ–ï¼ˆå¤©æ°”å·¥å…·ï¼‰
```bash
pip install requests
```

### å½±åƒå·¥å…·ä¾èµ–
```bash
# Google Earth å’Œå‰æ—ä¸€å·
pip install Pillow numpy mercantile

# Sentinel-2ï¼ˆå¯é€‰ï¼‰
pip install earthengine-api geemap pandas
```

### ä¸€é”®å®‰è£…æ‰€æœ‰ä¾èµ–
```bash
pip install -r requirements_gis.txt
```

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### 1. å¤©æ°”æŸ¥è¯¢ç¤ºä¾‹
```python
import asyncio
from swagent.tools.domain import WeatherTool

async def main():
    weather = WeatherTool()

    # æŸ¥è¯¢å½“å‰å¤©æ°”
    result = await weather.safe_execute(
        latitude=39.9042,
        longitude=116.4074
    )

    if result.success:
        print(f"æ¸©åº¦: {result.data['data']['temperature_2m']}Â°C")

asyncio.run(main())
```

### 2. å½±åƒæŸ¥è¯¢ç¤ºä¾‹
```python
import asyncio
from swagent.tools.domain import ImageryTool

async def main():
    imagery = ImageryTool()

    # æŸ¥è¯¢ Google Earth å½±åƒ
    result = await imagery.safe_execute(
        location=[116.4074, 39.9042],
        source="google",
        zoom_level=18,
        point_size=1000
    )

    if result.success:
        print(f"å½±åƒå½¢çŠ¶: {result.data['shape']}")

asyncio.run(main())
```

### 3. è¿è¡Œå®Œæ•´ç¤ºä¾‹
```bash
python examples/gis_agent_demo.py
```

## ğŸ“Š æµ‹è¯•ç»“æœ

### å¤©æ°”å·¥å…·æµ‹è¯• âœ…
```
1. æŸ¥è¯¢åŒ—äº¬å½“å‰å¤©æ°”:
âœ… æˆåŠŸ!
  æ—¶é—´: 2026-01-20T10:15
  æ¸©åº¦: -8.9Â°C
  æ¹¿åº¦: 22%
  é™æ°´: 0.0 mm
  é£é€Ÿ: 8.1 km/h

2. æŸ¥è¯¢æŒ‡å®šæ—¶é—´å¤©æ°”:
âœ… æˆåŠŸ!
  æ—¶é—´: 2026-01-20T14:00
  æ¸©åº¦: -4.8Â°C
```

### å½±åƒå·¥å…·æµ‹è¯• âš ï¸
- å·¥å…·æ¶æ„æ­£ç¡®ï¼Œæ¥å£å®Œæ•´
- éœ€è¦å®‰è£…é¢å¤–ä¾èµ–ï¼š`mercantile`ï¼ˆGoogle/Jilinï¼‰ã€`earthengine-api`ï¼ˆSentinelï¼‰
- å®‰è£…ä¾èµ–åå¯æ­£å¸¸ä½¿ç”¨

## ğŸ”§ å·¥å…·ç‰¹æ€§

### WeatherTool
| ç‰¹æ€§ | çŠ¶æ€ |
|------|------|
| å½“å‰å¤©æ°”æŸ¥è¯¢ | âœ… |
| æŒ‡å®šæ—¶é—´æŸ¥è¯¢ | âœ… |
| è‡ªå®šä¹‰æ—¶åŒº | âœ… |
| æ— éœ€ API Key | âœ… |
| å‚æ•°éªŒè¯ | âœ… |
| é”™è¯¯å¤„ç† | âœ… |
| æ—¥å¿—è®°å½• | âœ… |

### ImageryTool
| ç‰¹æ€§ | çŠ¶æ€ |
|------|------|
| Google Earth æ•°æ®æº | âœ… |
| å‰æ—ä¸€å·æ•°æ®æº | âœ… |
| Sentinel-2 æ•°æ®æº | âœ… |
| ç‚¹ä½æ¨¡å¼ | âœ… |
| åŒºåŸŸæ¨¡å¼ | âœ… |
| å¤šå¹´ä»½æ”¯æŒ | âœ… |
| äº‘é‡è¿‡æ»¤ | âœ… |
| Base64 ç¼–ç  | âœ… |
| ä¾èµ–æ£€æµ‹ | âœ… |

## ğŸ“ æ–‡ä»¶ç»“æ„

```
swagent/
â”œâ”€â”€ tools/domain/
â”‚   â”œâ”€â”€ weather_tool.py          # å¤©æ°”æŸ¥è¯¢å·¥å…· âœ…
â”‚   â”œâ”€â”€ imagery_tool.py          # å½±åƒåˆ‡ç‰‡å·¥å…· âœ…
â”‚   â””â”€â”€ __init__.py              # å·¥å…·å¯¼å‡º âœ…
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ gis_agent_demo.py        # GIS å·¥å…·ç¤ºä¾‹ âœ…
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ GIS_TOOLS.md             # ä½¿ç”¨æ–‡æ¡£ âœ…
â””â”€â”€ requirements_gis.txt         # GIS ä¾èµ– âœ…

æ•°æ®æ¥å£/                        # å½±åƒæ•°æ®æ¥å£
â”œâ”€â”€ opts_google.py               # Google Earth ä¸‹è½½å™¨
â”œâ”€â”€ opts_jilin.py                # å‰æ—ä¸€å·ä¸‹è½½å™¨
â””â”€â”€ opts_sentinel.py             # Sentinel-2 å¤„ç†å™¨
```

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

1. **ç»Ÿä¸€æ¥å£**: æ‰€æœ‰å·¥å…·éµå¾ª `BaseTool` è§„èŒƒï¼Œæ¥å£ç»Ÿä¸€
2. **å¼‚æ­¥æ”¯æŒ**: æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œæ€§èƒ½ä¼˜ç§€
3. **é”™è¯¯å¤„ç†**: å®Œå–„çš„å‚æ•°éªŒè¯å’Œå¼‚å¸¸å¤„ç†
4. **çµæ´»é›†æˆ**: å¯å•ç‹¬ä½¿ç”¨æˆ–é›†æˆåˆ° Agent ä¸­
5. **OpenAI å…¼å®¹**: æ”¯æŒ Function Calling æ ¼å¼
6. **ä¾èµ–éš”ç¦»**: å½±åƒå·¥å…·çš„ä¾èµ–æ˜¯å¯é€‰çš„ï¼Œä¸å½±å“å¤©æ°”å·¥å…·ä½¿ç”¨

## ğŸ” ä¸ç°æœ‰æ¡†æ¶é›†æˆ

### ä¸ ToolRegistry é›†æˆ
```python
from swagent.tools import ToolRegistry
from swagent.tools.domain import WeatherTool, ImageryTool

registry = ToolRegistry()
registry.register(WeatherTool())
registry.register(ImageryTool())

# ç»Ÿä¸€è°ƒç”¨
result = await registry.execute_tool("weather_query", ...)
```

### ä¸ Agent é›†æˆ
```python
# è·å– OpenAI Function æ ¼å¼
functions = registry.to_openai_functions()

# ä¼ é€’ç»™ Agent ä½¿ç”¨ï¼ˆé€šè¿‡ Function Callingï¼‰
# agent = YourAgent(tools=functions)
```

## ğŸ“ ä½¿ç”¨æ–‡æ¡£

è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜è¯·æŸ¥çœ‹ï¼š
- **å®Œæ•´æ–‡æ¡£**: `docs/GIS_TOOLS.md`
- **ç¤ºä¾‹ä»£ç **: `examples/gis_agent_demo.py`
- **API å‚è€ƒ**: å·¥å…·ç±»çš„ docstring

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç½‘ç»œä¾èµ–**: æ‰€æœ‰å·¥å…·éƒ½éœ€è¦ç½‘ç»œè¿æ¥
2. **API é™åˆ¶**: Open-Meteo API æœ‰è¯·æ±‚é¢‘ç‡é™åˆ¶
3. **å½±åƒä¾èµ–**: å½±åƒå·¥å…·éœ€è¦é¢å¤–å®‰è£…ä¾èµ–åŒ…
4. **Sentinel é…ç½®**: ä½¿ç”¨ Sentinel-2 éœ€è¦å…ˆè¿›è¡Œ Google Earth Engine è®¤è¯

## ğŸ‰ æ€»ç»“

æ‰€æœ‰ä»»åŠ¡å·²å®Œæˆï¼ä¸¤ä¸ª GIS Agent å·¥å…·å·²æˆåŠŸå®ç°å¹¶é›†æˆåˆ° SWAgent æ¡†æ¶ä¸­ï¼š

- âœ… **å¤©æ°”æŸ¥è¯¢å·¥å…·**: å®Œå…¨å¯ç”¨ï¼Œå·²æµ‹è¯•é€šè¿‡
- âœ… **å½±åƒåˆ‡ç‰‡å·¥å…·**: æ¶æ„å®Œæ•´ï¼Œæ”¯æŒä¸‰ç§æ•°æ®æº
- âœ… **æ–‡æ¡£é½å…¨**: ä½¿ç”¨æŒ‡å—ã€API æ–‡æ¡£ã€ç¤ºä¾‹ä»£ç 
- âœ… **æ¡†æ¶é›†æˆ**: å·²æ³¨å†Œåˆ°å·¥å…·ç³»ç»Ÿï¼Œæ”¯æŒ Agent è°ƒç”¨

ç”¨æˆ·å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›å·¥å…·è¿›è¡Œå¤©æ°”æŸ¥è¯¢å’Œå«æ˜Ÿå½±åƒè·å–ï¼
