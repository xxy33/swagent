# 阶段1测试指南

## 已完成内容

✅ **LLM接口层** - 阶段1完成

实现的模块：
- `swagent/utils/config.py` - 配置管理系统
- `swagent/utils/logger.py` - 日志系统
- `swagent/llm/base_llm.py` - LLM基类
- `swagent/llm/openai_client.py` - OpenAI兼容客户端
- `tests/test_phase1.py` - 阶段1测试脚本

## 配置步骤

### 1. 创建环境变量文件

在项目根目录创建 `.env` 文件：

```bash
# .env
OPENAI_API_KEY=your_api_key_here
```

**重要**：将 `your_api_key_here` 替换为你的实际API密钥。

### 2. 修改Base URL（如果需要）

如果你使用的是OpenAI兼容的API（如本地部署的模型、第三方API等），需要修改 `config.yaml` 文件：

打开 `/root/swagent/config.yaml`，找到：

```yaml
llm:
  providers:
    openai:
      base_url: "https://api.openai.com/v1"  # 修改这里
```

修改为你的API地址，例如：
```yaml
base_url: "https://your-api-endpoint.com/v1"
```

### 3. 安装依赖

```bash
cd /root/swagent
pip install -r requirements.txt
```

## 运行测试

```bash
cd /root/swagent
python tests/test_phase1.py
```

## 测试内容

测试脚本会依次测试：

1. **配置系统** - 验证配置文件读取和环境变量替换
2. **日志系统** - 验证日志输出功能
3. **LLM连接** - 发送简单消息测试API连接
4. **流式响应** - 测试流式输出功能

## 预期结果

如果配置正确，你应该看到类似输出：

```
╔══════════════════════════════════════════════════════════╗
║               SWAgent - 阶段1测试                        ║
║                    LLM接口层                             ║
╚══════════════════════════════════════════════════════════╝

============================================================
测试1: 配置系统
============================================================
✓ 应用名称: SolidWaste-Agent
✓ 应用版本: 0.1.0
✓ 默认LLM提供商: openai
✓ LLM模型: gpt-4
✓ Base URL: https://api.openai.com/v1
✓ API Key已配置: 是

============================================================
测试2: 日志系统
============================================================
✓ 日志系统工作正常

============================================================
测试3: LLM连接测试
============================================================
✓ 客户端创建成功
发送测试消息...
✓ LLM响应成功!
...

============================================================
测试总结
============================================================
配置系统: ✓ 通过
日志系统: ✓ 通过
LLM连接: ✓ 通过
流式响应: ✓ 通过

总计: 4/4 通过

🎉 阶段1测试全部通过! 可以继续阶段2。
```

## 故障排查

### API密钥未配置

如果看到"API Key已配置: 否"，请检查：
- `.env` 文件是否存在
- `.env` 文件中 `OPENAI_API_KEY` 是否设置
- `.env` 文件是否在项目根目录

### LLM连接失败

可能的原因：
1. API密钥错误或已过期
2. Base URL配置错误
3. 网络连接问题
4. API配额已用完

检查方法：
```bash
# 检查环境变量
cat /root/swagent/.env

# 检查配置文件
cat /root/swagent/config.yaml | grep -A 10 "llm:"
```

## 下一步

测试通过后，可以进入**阶段2：Agent基础框架**的开发。

阶段2将实现：
- Agent基类
- 上下文管理
- 第一个具体Agent（PlannerAgent）
